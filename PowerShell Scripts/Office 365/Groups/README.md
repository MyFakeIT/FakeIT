# Microsoft 365 Group Privacy Management Scripts

This repository contains three PowerShell scripts designed to manage Microsoft 365 Group privacy in an Office 365 tenant. These scripts allow you to identify Public groups and switch them to Private, ensuring membership requires owner approval or invitation while preserving existing sharing settings.

## Scripts

### 1. Export-PublicGroupsToCSV.ps1
- **Purpose**: Identifies all Public Microsoft 365 Groups in your tenant and exports their details to a CSV file for review or later use with Script 2.
- **Output**: Saves `PublicGroups.csv` to your Desktop (`$env:USERPROFILE\Desktop\PublicGroups.csv`).
- **Details**: 
  - Retrieves all groups using `-ResultSize Unlimited` to ensure no limits truncate the list.
  - Exports `DisplayName`, `PrimarySmtpAddress`, `AccessType`, and `Identity` for each Public group.
  - Displays a sample of the first 5 groups found for verification.
- **Usage**: 
  ```powershell
  .\Export-PublicGroupsToCSV.ps1


### 2. Set-PublicGroupsToPrivateFromCSV.ps1
- **Purpose**: Switches Microsoft 365 Groups listed in `PublicGroups.csv` from Public to Private, requiring owner approval for join requests.
- **Input**: Reads from `PublicGroups.csv` on your Desktop (generated by Script 1).
- **Details**: 
  - Applies `-AccessType Private` to restrict visibility and access to members only.
  - Preserves existing `SubscriptionEnabled` settings, allowing self-joining requests with owner approval if previously enabled.
  - Provides feedback for each group changed.
- **Usage**: 
  ```powershell
  .\Set-PublicGroupsToPrivateFromCSV.ps1


### 3. Set-AllPublicGroupsToPrivate.ps1
- **Purpose**: Directly switches all Public Microsoft 365 Groups in the tenant to Private without needing a CSV, ensuring membership requires owner approval or invitation.
- **Details**: 
  - Uses `-ResultSize Unlimited` to identify all Public groups, ensuring no limits truncate the list.
  - Sets `-AccessType Private`, allowing self-joining requests with owner approval if `SubscriptionEnabled` is `$true` (unchanged from prior settings).
  - Outputs progress for each group modified.
- **Usage**: 
  ```powershell
  .\Set-AllPublicGroupsToPrivate.ps1


## Prerequisites
- **PowerShell Module**: `ExchangeOnlineManagement`
  - **Install**: `Install-Module -Name ExchangeOnlineManagement`
- **Permissions**: Exchange Admin or Global Admin rights
- **Execution**: Run in an elevated PowerShell session

## Workflow
### Option 1: Review Before Changing
1. Run `Export-PublicGroupsToCSV.ps1` to generate `PublicGroups.csv`.
2. Review/edit the CSV to select specific groups (optional).
3. Run `Set-PublicGroupsToPrivateFromCSV.ps1` to apply changes to listed groups.

### Option 2: Immediate Change
- Run `Set-AllPublicGroupsToPrivate.ps1` to switch all Public groups to Private in one step.

## Notes
- **Privacy Setting**: All scripts set `-AccessType Private`, restricting visibility and access to members. Self-joining requests are allowed (if `SubscriptionEnabled` is `$true`), requiring owner approval.
- **Sharing**: Existing sharing settings (e.g., external invites) remain unchanged.
- **Verification**: After running, use:
  ```powershell
  Get-UnifiedGroup -ResultSize Unlimited | Where-Object { $_.AccessType -eq "Public" }
    - No results mean all Public groups are now Private.

## Author
- FakeIT (IT assisted)
- **Date**: March 06, 2025
















